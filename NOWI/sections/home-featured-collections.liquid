<section class="section section--collections">
  <div class="container">
    {% if section.settings.heading != blank %}
      <div class="section-heading">{{ section.settings.heading | escape }}</div>
    {% endif %}
    {% if section.settings.subheading != blank %}
      <p class="section-subheading">{{ section.settings.subheading | escape }}</p>
    {% endif %}

    <div class="collection-grid">
      {% for block in section.blocks %}
        {% assign collection = collections[block.settings.collection] %}
        <a href="{{ collection.url | default: block.settings.fallback_link }}" class="collection-card" {{ block.shopify_attributes }}>
          {% if collection.image %}
            <img src="{{ collection.image | img_url: '800x' }}" alt="{{ collection.title | escape }}" loading="lazy">
          {% elsif block.settings.image %}
            <img src="{{ block.settings.image | img_url: '800x' }}" alt="{{ block.settings.title | escape }}" loading="lazy">
          {% else %}
            <div class="collection-card__placeholder"></div>
          {% endif %}
          <div class="collection-card__content">
            <span class="pill">{{ block.settings.eyebrow | escape }}</span>
            <h3>{{ block.settings.title | default: collection.title | escape }}</h3>
            {% if block.settings.subtitle != blank %}
              <p>{{ block.settings.subtitle | escape }}</p>
            {% endif %}
          </div>
        </a>
      {% else %}
        {% for i in (1..3) %}
          <div class="collection-card">
            <div class="collection-card__placeholder"></div>
            <div class="collection-card__content">
              <span class="pill">Collection</span>
              <h3>Signature Capsule {{ i }}</h3>
              <p>Elevated staples engineered for daily motion.</p>
            </div>
          </div>
        {% endfor %}
      {% endfor %}
    </div>

    {% if section.settings.cta_label != blank %}
      <div class="section-cta">
        <a class="btn btn-outline" href="{{ section.settings.cta_link }}">{{ section.settings.cta_label | escape }}</a>
      </div>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Featured collections",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Build your uniform"
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Subheading",
      "default": "Explore our modular capsules crafted for studio, street and travel."
    },
    {
      "type": "text",
      "id": "cta_label",
      "label": "CTA label",
      "default": "Shop all collections"
    },
    {
      "type": "url",
      "id": "cta_link",
      "label": "CTA link"
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Collection",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Override image"
        },
        {
          "type": "text",
          "id": "eyebrow",
          "label": "Badge",
          "default": "Essential"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title"
        },
        {
          "type": "textarea",
          "id": "subtitle",
          "label": "Subtitle"
        },
        {
          "type": "url",
          "id": "fallback_link",
          "label": "Fallback link"
        }
      ]
    }
  ],
  "max_blocks": 6,
  "presets": [
    {
      "name": "Featured collections",
      "blocks": [
        { "type": "collection" },
        { "type": "collection" },
        { "type": "collection" }
      ]
    }
  ]
}
{% endschema %}
