{%- comment -%}
  Product Card Snippet
  Renders a single product card with image, rating, price, discount, and wishlist button
  Variables:
    - product: Shopify product object
    - show_rating: Boolean to show rating badge (default: true)
{%- endcomment -%}

<div class="product-card" data-product-id="{{ product.id }}">
  <!-- Product Image Container -->
  <div class="product-card__image-container">
    {% if product.featured_image %}
      <img 
        src="{{ product.featured_image | image_url: width: 400 }}" 
        alt="{{ product.featured_image.alt | escape }}"
        class="product-card__image"
        loading="lazy"
        width=""
        height=""
      >
    {% else %}
      <div class="product-card__image product-card__image--placeholder">
        {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
      </div>
    {% endif %}

    <!-- Wishlist Heart Button -->
    <button 
      class="product-card__wishlist-btn" 
      aria-label="Add to wishlist"
      data-wishlist-btn
      title="Add to wishlist"
    >
      <svg class="product-card__heart-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
      </svg>
    </button>

    <!-- Rating Badge (Bottom Left) -->
    {% if product.metafields.reviews and product.metafields.reviews.rating %}
      <div class="product-card__rating">
        <span class="product-card__rating-value">
          {{ product.metafields.reviews.rating.value | default: '4.0' }}
        </span>
        <span class="product-card__rating-star">â˜…</span>
      </div>
    {% endif %}
  </div>

  <!-- Product Info -->
  <div class="product-card__content">
    <!-- Product Title -->
    <h3 class="product-card__title">
      <a href="{{ product.url }}" class="product-card__title-link">
        {{ product.title | escape }}
      </a>
    </h3>

    <!-- Pricing Section -->
    <div class="product-card__pricing">
      <!-- Sale Price -->
      <span class="product-card__price product-card__price--current">
        {{ product.price | money_without_trailing_zeros }}
      </span>

      <!-- Original Price (if on sale) -->
      {% if product.compare_at_price %}
        <span class="product-card__price product-card__price--original">
          {{ product.compare_at_price | money_without_trailing_zeros }}
        </span>
      {% endif %}
    </div>

    <!-- Best Price with Coupon Text -->
    <p class="product-card__coupon-text">
      Best price with coupon
    </p>

    <!-- Discount Badge -->
    {% if product.compare_at_price %}
      {% assign discount_percent = product.compare_at_price | minus: product.price | times: 100 | divided_by: product.compare_at_price | round %}
      <div class="product-card__discount-badge">
        {{ discount_percent }}% OFF
      </div>
    {% endif %}

    <!-- Delivery Info -->
    <p class="product-card__delivery">
      Delivery by Nov 17
    </p>

    <!-- Add to Cart Button -->
    <button 
      class="product-card__add-btn"
      data-add-to-cart
      data-product-id="{{ product.id }}"
      aria-label="Add {{ product.title }} to cart"
    >
      Add to Cart
    </button>
  </div>
</div>
